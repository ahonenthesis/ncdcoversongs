% Calculates OTI values
function calcOTImat(qlist,tlist,matdir,outputfile,k)


ql=textread(qlist,'%s');
tl=textread(tlist,'%s');

qlen=size(ql,1);
tlen=size(tl,1);

tposes=zeros(qlen,tlen,k);

for ix=1:qlen
    foo=load(strrep(ql{ix},'gmats/',matdir));
    qdata=foo.data;
    for jx=1:tlen
        foobar=load(strrep(tl{jx},'gmats/',matdir));
        tdata=foobar.data;
        kotis=koti(qdata,tdata,k);
        for kx=1:k
            tposes(ix,jx,kx)=kotis(kx);
        end
    end
end

save(outputfile,'tposes');

end
